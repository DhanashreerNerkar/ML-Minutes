<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hidden Markov Models Explained</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.7;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        h2 {
            color: #764ba2;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        h3 {
            color: #34495e;
            margin: 20px 0 15px 0;
        }
        .intro-story {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .concept-box {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
            transition: transform 0.3s;
        }
        .concept-box:hover {
            transform: translateX(5px);
        }
        .hmm-visual {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }
        .state-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }
        .state {
            background: white;
            padding: 20px;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            position: relative;
            transition: all 0.3s;
        }
        .hidden-state {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }
        .observable-state {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            font-weight: bold;
        }
        .state:hover {
            transform: scale(1.1);
        }
        .arrow {
            position: absolute;
            width: 80px;
            height: 2px;
            background: #667eea;
            top: 50%;
            right: -80px;
            transform-origin: left center;
        }
        .arrow::after {
            content: '>';
            position: absolute;
            right: -10px;
            top: -8px;
            font-size: 20px;
            color: #667eea;
        }
        .real-example {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .weather-demo {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .day-sequence {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        .day-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            min-width: 100px;
            text-align: center;
            margin: 0 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .day-card:hover {
            transform: translateY(-5px);
        }
        .weather-icon {
            font-size: 2em;
            margin: 10px 0;
        }
        .probability-matrix {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .probability-matrix th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
        }
        .probability-matrix td {
            padding: 10px;
            text-align: center;
            background: white;
            border: 1px solid #ecf0f1;
        }
        .probability-matrix tr:hover td {
            background: #f8f9fa;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        .formula-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
            font-family: 'Courier New', monospace;
        }
        .info-box {
            background: #e8f4f8;
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #f39c12;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .success-box {
            background: #d4edda;
            border-left: 5px solid #27ae60;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .algorithm-steps {
            counter-reset: step-counter;
        }
        .algorithm-step {
            position: relative;
            padding-left: 50px;
            margin: 20px 0;
            counter-increment: step-counter;
        }
        .algorithm-step::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .application-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .application-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-top: 5px solid #667eea;
            transition: transform 0.3s;
        }
        .application-card:hover {
            transform: translateY(-5px);
        }
        .chart-container {
            width: 100%;
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }
        .highlight {
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            border-bottom: 2px solid #ecf0f1;
        }
        .tab {
            padding: 12px 24px;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s;
            font-size: 16px;
        }
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .tab-content {
            display: none;
            padding: 20px 0;
        }
        .tab-content.active {
            display: block;
        }
        .viterbi-path {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
        }
        .path-node {
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin: 0 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            min-width: 80px;
            text-align: center;
        }
        .path-arrow {
            font-size: 1.5em;
            color: #667eea;
            margin: 0 5px;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .animate-pulse {
            animation: pulse 2s infinite;
        }
        .interactive-demo {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔮 Hidden Markov Models (HMM)</h1>
        <p class="subtitle">Uncovering Hidden States from Observable Events</p>

        <div class="intro-story">
            <h2 style="color: #e67e22; border: none;">🏥 The Doctor's Diagnosis Story</h2>
            <p>Imagine you're a doctor who can't directly see if a patient has the flu. You can only observe symptoms:</p>
            <ul style="margin: 15px 0;">
                <li><strong>Hidden State:</strong> Patient's actual health (Healthy or Flu)</li>
                <li><strong>Observable:</strong> Symptoms (Normal, Cold, Fever)</li>
                <li><strong>Challenge:</strong> Determine the most likely health states over time based on symptoms</li>
            </ul>
            <p style="margin-top: 15px;">This is exactly what HMMs do - they infer hidden states from observable sequences!</p>
        </div>

        <h2>🎯 What is a Hidden Markov Model?</h2>
        <div class="concept-box">
            <h3>Core Definition</h3>
            <p>An <strong>HMM</strong> is a statistical model where:</p>
            <ol>
                <li>The system has <span class="highlight">hidden states</span> that we can't directly observe</li>
                <li>We can only see <span class="highlight">observations</span> that depend on these hidden states</li>
                <li>States follow the <span class="highlight">Markov property</span>: future depends only on present, not past</li>
            </ol>
            
            <div class="formula-box">
                <strong>Markov Property:</strong><br>
                P(State_tomorrow | State_today, State_yesterday) = P(State_tomorrow | State_today)
            </div>
        </div>

        <h2>🔄 HMM Components Visualized</h2>
        <div class="hmm-visual">
            <h3>The Three Key Components</h3>
            <div class="state-container">
                <div class="hidden-state">
                    Hidden States<br>
                    (Can't see)<br>
                    🔒
                </div>
                <div class="observable-state">
                    Observations<br>
                    (Can see)<br>
                    👁️
                </div>
            </div>
            
            <div class="info-box">
                <h4>1️⃣ States (Hidden)</h4>
                <p>The true conditions we want to know but can't observe directly</p>
                
                <h4>2️⃣ Observations (Visible)</h4>
                <p>What we can actually see or measure</p>
                
                <h4>3️⃣ Probabilities</h4>
                <ul>
                    <li><strong>Transition:</strong> Probability of moving between hidden states</li>
                    <li><strong>Emission:</strong> Probability of observing something given a hidden state</li>
                    <li><strong>Initial:</strong> Probability of starting in each state</li>
                </ul>
            </div>
        </div>

        <h2>☁️ Classic Example: Weather Prediction</h2>
        <div class="weather-demo">
            <h3>Scenario: You're in a sealed room, predicting weather</h3>
            <p>Your friend only tells you what they wore each day (observations), and you need to figure out the weather (hidden states).</p>
            
            <div class="day-sequence">
                <div class="day-card">
                    <strong>Day 1</strong>
                    <div class="weather-icon">🧥</div>
                    <p>Jacket</p>
                    <p style="color: #667eea;">Weather: ?</p>
                </div>
                <div class="day-card">
                    <strong>Day 2</strong>
                    <div class="weather-icon">👕</div>
                    <p>T-shirt</p>
                    <p style="color: #667eea;">Weather: ?</p>
                </div>
                <div class="day-card">
                    <strong>Day 3</strong>
                    <div class="weather-icon">👕</div>
                    <p>T-shirt</p>
                    <p style="color: #667eea;">Weather: ?</p>
                </div>
                <div class="day-card">
                    <strong>Day 4</strong>
                    <div class="weather-icon">☂️</div>
                    <p>Umbrella</p>
                    <p style="color: #667eea;">Weather: ?</p>
                </div>
                <div class="day-card">
                    <strong>Day 5</strong>
                    <div class="weather-icon">🧥</div>
                    <p>Jacket</p>
                    <p style="color: #667eea;">Weather: ?</p>
                </div>
            </div>
            
            <h4>Transition Probabilities (Weather Changes)</h4>
            <table class="probability-matrix">
                <thead>
                    <tr>
                        <th>From \ To</th>
                        <th>☀️ Sunny</th>
                        <th>🌧️ Rainy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>☀️ Sunny</strong></td>
                        <td>0.7</td>
                        <td>0.3</td>
                    </tr>
                    <tr>
                        <td><strong>🌧️ Rainy</strong></td>
                        <td>0.4</td>
                        <td>0.6</td>
                    </tr>
                </tbody>
            </table>
            
            <h4>Emission Probabilities (Weather → Clothing)</h4>
            <table class="probability-matrix">
                <thead>
                    <tr>
                        <th>Weather</th>
                        <th>👕 T-shirt</th>
                        <th>🧥 Jacket</th>
                        <th>☂️ Umbrella</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>☀️ Sunny</strong></td>
                        <td>0.6</td>
                        <td>0.3</td>
                        <td>0.1</td>
                    </tr>
                    <tr>
                        <td><strong>🌧️ Rainy</strong></td>
                        <td>0.1</td>
                        <td>0.4</td>
                        <td>0.5</td>
                    </tr>
                </tbody>
            </table>
            
            <button onclick="solveWeatherHMM()">Solve with Viterbi Algorithm</button>
            <div id="weatherSolution"></div>
        </div>

        <h2>🧮 The Three Fundamental Problems of HMMs</h2>
        <div class="concept-box">
            <h3>1️⃣ Evaluation Problem</h3>
            <p><strong>Question:</strong> Given the model and observations, what's the probability of seeing this sequence?</p>
            <p><strong>Solution:</strong> Forward Algorithm</p>
            <p><strong>Use Case:</strong> How likely is this speech pattern to be the word "hello"?</p>
        </div>
        
        <div class="concept-box">
            <h3>2️⃣ Decoding Problem</h3>
            <p><strong>Question:</strong> Given observations, what's the most likely sequence of hidden states?</p>
            <p><strong>Solution:</strong> Viterbi Algorithm</p>
            <p><strong>Use Case:</strong> What words were most likely spoken given the audio?</p>
        </div>
        
        <div class="concept-box">
            <h3>3️⃣ Learning Problem</h3>
            <p><strong>Question:</strong> Given observations, how do we learn the model parameters?</p>
            <p><strong>Solution:</strong> Baum-Welch Algorithm (EM algorithm)</p>
            <p><strong>Use Case:</strong> Train the speech recognition model from examples</p>
        </div>

        <h2>🏥 Real Example: Medical Diagnosis System</h2>
        <div class="real-example">
            <h3>Tracking Patient Health Over Time</h3>
            <p>A hospital uses HMM to monitor ICU patients:</p>
            
            <div class="algorithm-steps">
                <div class="algorithm-step">
                    <strong>Hidden States:</strong> {Healthy, Mild Illness, Severe Illness}
                </div>
                <div class="algorithm-step">
                    <strong>Observations:</strong> {Normal Vitals, Elevated Temp, High Fever, Low BP}
                </div>
                <div class="algorithm-step">
                    <strong>Goal:</strong> Predict patient's actual condition from vital signs
                </div>
            </div>
            
            <div class="interactive-demo">
                <h4>Patient Monitoring Simulation</h4>
                <button onclick="simulatePatientHMM()">Run Patient Monitoring</button>
                <div id="patientResults"></div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="hmmChart"></canvas>
        </div>

        <h2>🚀 Real-World Applications</h2>
        <div class="application-grid">
            <div class="application-card">
                <h3>🎤 Speech Recognition</h3>
                <p><strong>Hidden:</strong> Words/Phonemes</p>
                <p><strong>Observable:</strong> Audio signals</p>
                <p><strong>Example:</strong> Siri, Alexa understanding speech</p>
                <ul style="margin-top: 10px;">
                    <li>Convert audio waves to text</li>
                    <li>Handle accents and noise</li>
                    <li>Real-time transcription</li>
                </ul>
            </div>
            
            <div class="application-card">
                <h3>📈 Stock Market Analysis</h3>
                <p><strong>Hidden:</strong> Market regime (Bull/Bear)</p>
                <p><strong>Observable:</strong> Price movements</p>
                <p><strong>Example:</strong> Algorithmic trading</p>
                <ul style="margin-top: 10px;">
                    <li>Detect market transitions</li>
                    <li>Risk management</li>
                    <li>Trading strategies</li>
                </ul>
            </div>
            
            <div class="application-card">
                <h3>🧬 Bioinformatics</h3>
                <p><strong>Hidden:</strong> Gene regions</p>
                <p><strong>Observable:</strong> DNA sequences</p>
                <p><strong>Example:</strong> Gene prediction</p>
                <ul style="margin-top: 10px;">
                    <li>Find coding regions</li>
                    <li>Identify gene boundaries</li>
                    <li>Protein structure prediction</li>
                </ul>
            </div>
            
            <div class="application-card">
                <h3>✋ Gesture Recognition</h3>
                <p><strong>Hidden:</strong> Intended gesture</p>
                <p><strong>Observable:</strong> Sensor readings</p>
                <p><strong>Example:</strong> Sign language translation</p>
                <ul style="margin-top: 10px;">
                    <li>VR/AR interfaces</li>
                    <li>Accessibility tools</li>
                    <li>Gaming controls</li>
                </ul>
            </div>
            
            <div class="application-card">
                <h3>📝 Natural Language Processing</h3>
                <p><strong>Hidden:</strong> Parts of speech</p>
                <p><strong>Observable:</strong> Words</p>
                <p><strong>Example:</strong> POS tagging</p>
                <ul style="margin-top: 10px;">
                    <li>Grammar checking</li>
                    <li>Machine translation</li>
                    <li>Named entity recognition</li>
                </ul>
            </div>
            
            <div class="application-card">
                <h3>🎵 Music Analysis</h3>
                <p><strong>Hidden:</strong> Chord progressions</p>
                <p><strong>Observable:</strong> Audio frequencies</p>
                <p><strong>Example:</strong> Automatic transcription</p>
                <ul style="margin-top: 10px;">
                    <li>Chord detection</li>
                    <li>Beat tracking</li>
                    <li>Genre classification</li>
                </ul>
            </div>
        </div>

        <h2>💻 Implementation Examples</h2>
        <div class="tabs">
            <button class="tab active" onclick="showTab('python')">Python Implementation</button>
            <button class="tab" onclick="showTab('viterbi')">Viterbi Algorithm</button>
            <button class="tab" onclick="showTab('applications')">Real Applications</button>
        </div>

        <div id="python" class="tab-content active">
            <div class="code-block">
# Simple HMM Implementation for Weather Prediction
import numpy as np

class HiddenMarkovModel:
    def __init__(self, states, observations):
        self.states = states
        self.observations = observations
        self.n_states = len(states)
        self.n_observations = len(observations)
        
    def set_probabilities(self, initial, transition, emission):
        """
        initial: Initial state probabilities
        transition: State transition matrix
        emission: Observation emission matrix
        """
        self.initial_prob = initial
        self.transition_prob = transition
        self.emission_prob = emission
    
    def viterbi(self, observed_sequence):
        """
        Find most likely hidden state sequence
        """
        T = len(observed_sequence)
        N = self.n_states
        
        # Initialize probability matrix
        prob = np.zeros((N, T))
        path = np.zeros((N, T), dtype=int)
        
        # Initialize first column
        for s in range(N):
            obs_idx = self.observations.index(observed_sequence[0])
            prob[s, 0] = self.initial_prob[s] * self.emission_prob[s][obs_idx]
        
        # Forward pass
        for t in range(1, T):
            obs_idx = self.observations.index(observed_sequence[t])
            for s in range(N):
                probabilities = prob[:, t-1] * self.transition_prob[:, s] * self.emission_prob[s][obs_idx]
                path[s, t] = np.argmax(probabilities)
                prob[s, t] = np.max(probabilities)
        
        # Backward pass - find optimal path
        optimal_path = np.zeros(T, dtype=int)
        optimal_path[-1] = np.argmax(prob[:, -1])
        
        for t in range(T-2, -1, -1):
            optimal_path[t] = path[optimal_path[t+1], t+1]
        
        return [self.states[i] for i in optimal_path]

# Example: Weather HMM
weather_hmm = HiddenMarkovModel(
    states=['Sunny', 'Rainy'],
    observations=['T-shirt', 'Jacket', 'Umbrella']
)

# Set probabilities
initial = np.array([0.6, 0.4])  # 60% sunny, 40% rainy initially
transition = np.array([
    [0.7, 0.3],  # Sunny -> Sunny: 0.7, Sunny -> Rainy: 0.3
    [0.4, 0.6]   # Rainy -> Sunny: 0.4, Rainy -> Rainy: 0.6
])
emission = np.array([
    [0.6, 0.3, 0.1],  # Sunny: T-shirt: 0.6, Jacket: 0.3, Umbrella: 0.1
    [0.1, 0.4, 0.5]   # Rainy: T-shirt: 0.1, Jacket: 0.4, Umbrella: 0.5
])

weather_hmm.set_probabilities(initial, transition, emission)

# Decode observations
observations = ['Jacket', 'T-shirt', 'T-shirt', 'Umbrella', 'Jacket']
hidden_states = weather_hmm.viterbi(observations)

print("Observations:", observations)
print("Most likely weather:", hidden_states)
# Output: ['Rainy', 'Sunny', 'Sunny', 'Rainy', 'Rainy']
            </div>
        </div>

        <div id="viterbi" class="tab-content">
            <div class="code-block">
# Detailed Viterbi Algorithm Implementation
def viterbi_algorithm(observations, states, start_prob, trans_prob, emit_prob):
    """
    Viterbi algorithm for finding most likely state sequence
    
    Parameters:
    - observations: List of observations
    - states: List of possible hidden states
    - start_prob: Initial state probabilities
    - trans_prob: State transition probabilities
    - emit_prob: Emission probabilities
    """
    V = [{}]  # List of dicts to store probabilities
    path = {}
    
    # Initialize base cases (t=0)
    for state in states:
        V[0][state] = start_prob[state] * emit_prob[state][observations[0]]
        path[state] = [state]
    
    # Run Viterbi for t > 0
    for t in range(1, len(observations)):
        V.append({})
        new_path = {}
        
        for current_state in states:
            # Calculate probability for each possible previous state
            probabilities = []
            for prev_state in states:
                prob = V[t-1][prev_state] * \
                       trans_prob[prev_state][current_state] * \
                       emit_prob[current_state][observations[t]]
                probabilities.append((prob, prev_state))
            
            # Select the maximum probability
            max_prob, prev_state = max(probabilities)
            V[t][current_state] = max_prob
            new_path[current_state] = path[prev_state] + [current_state]
        
        path = new_path
    
    # Find the most probable final state
    final_probs = [(V[-1][state], state) for state in states]
    prob, state = max(final_probs)
    
    return prob, path[state]

# Example usage for speech recognition
states = ['Start', 'Middle', 'End']
observations = ['silence', 'speech', 'speech', 'speech', 'silence']

start_prob = {
    'Start': 0.8,
    'Middle': 0.15,
    'End': 0.05
}

trans_prob = {
    'Start': {'Start': 0.3, 'Middle': 0.6, 'End': 0.1},
    'Middle': {'Start': 0.1, 'Middle': 0.7, 'End': 0.2},
    'End': {'Start': 0.2, 'Middle': 0.1, 'End': 0.7}
}

emit_prob = {
    'Start': {'silence': 0.7, 'speech': 0.3},
    'Middle': {'silence': 0.1, 'speech': 0.9},
    'End': {'silence': 0.6, 'speech': 0.4}
}

prob, best_path = viterbi_algorithm(observations, states, start_prob, trans_prob, emit_prob)
print(f"Best path: {best_path}")
print(f"Probability: {prob}")
            </div>
        </div>

        <div id="applications" class="tab-content">
            <div class="code-block">
# Real Application: Stock Market Regime Detection
import numpy as np
from hmmlearn import hmm
import yfinance as yf

# Fetch stock data
stock = yf.download('SPY', start='2020-01-01', end='2023-12-31')
returns = stock['Close'].pct_change().dropna()

# Prepare data for HMM
X = returns.values.reshape(-1, 1)

# Create HMM model with 3 hidden states (Bull, Bear, Sideways)
model = hmm.GaussianHMM(n_components=3, covariance_type="full", n_iter=1000)

# Train the model
model.fit(X)

# Predict hidden states (market regimes)
hidden_states = model.predict(X)

# Interpret states based on mean returns
for i in range(3):
    state_returns = returns[hidden_states == i]
    print(f"State {i}: Mean Return = {state_returns.mean():.4f}, Volatility = {state_returns.std():.4f}")
    
    if state_returns.mean() > 0.001:
        regime = "Bull Market 📈"
    elif state_returns.mean() < -0.001:
        regime = "Bear Market 📉"
    else:
        regime = "Sideways Market ➡️"
    
    print(f"  Interpretation: {regime}")
    print(f"  Days in regime: {(hidden_states == i).sum()}")
    print()

# Speech Recognition Example using HMM
from python_speech_features import mfcc
import scipy.io.wavfile as wav

class SpeechHMM:
    def __init__(self, n_components=5):
        self.model = hmm.GaussianHMM(n_components=n_components)
        self.word_models = {}
    
    def train_word(self, word, audio_files):
        """Train HMM for a specific word"""
        features = []
        for audio_file in audio_files:
            rate, signal = wav.read(audio_file)
            mfcc_features = mfcc(signal, rate)
            features.append(mfcc_features)
        
        # Concatenate all features
        X = np.concatenate(features)
        
        # Train HMM for this word
        self.word_models[word] = hmm.GaussianHMM(n_components=5)
        self.word_models[word].fit(X)
    
    def recognize(self, audio_file):
        """Recognize which word was spoken"""
        rate, signal = wav.read(audio_file)
        mfcc_features = mfcc(signal, rate)
        
        # Score against each word model
        scores = {}
        for word, model in self.word_models.items():
            scores[word] = model.score(mfcc_features)
        
        # Return word with highest score
        return max(scores, key=scores.get)

# Bioinformatics: Gene Finding
class GeneFinderHMM:
    def __init__(self):
        self.states = ['Intergenic', 'Exon', 'Intron']
        self.nucleotides = ['A', 'C', 'G', 'T']
        
        # Typical transition probabilities
        self.transitions = {
            'Intergenic': {'Intergenic': 0.9, 'Exon': 0.1, 'Intron': 0.0},
            'Exon': {'Intergenic': 0.1, 'Exon': 0.7, 'Intron': 0.2},
            'Intron': {'Intergenic': 0.0, 'Exon': 0.3, 'Intron': 0.7}
        }
        
        # Emission probabilities (simplified)
        self.emissions = {
            'Intergenic': {'A': 0.25, 'C': 0.25, 'G': 0.25, 'T': 0.25},
            'Exon': {'A': 0.2, 'C': 0.3, 'G': 0.3, 'T': 0.2},
            'Intron': {'A': 0.3, 'C': 0.2, 'G': 0.2, 'T': 0.3}
        }
    
    def find_genes(self, dna_sequence):
        """Find gene regions in DNA sequence"""
        # Implementation would use Viterbi algorithm
        pass
            </div>
        </div>

        <h2>⚖️ HMM vs Other Models</h2>
        <div class="comparison-section">
            <table class="probability-matrix">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>HMM</th>
                        <th>RNN/LSTM</th>
                        <th>Regular Markov Chain</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Hidden States</strong></td>
                        <td>✅ Yes</td>
                        <td>✅ Yes (learned)</td>
                        <td>❌ No (all visible)</td>
                    </tr>
                    <tr>
                        <td><strong>Training Data Needed</strong></td>
                        <td>Medium</td>
                        <td>Large</td>
                        <td>Small</td>
                    </tr>
                    <tr>
                        <td><strong>Interpretability</strong></td>
                        <td>High</td>
                        <td>Low</td>
                        <td>Very High</td>
                    </tr>
                    <tr>
                        <td><strong>Long-term Dependencies</strong></td>
                        <td>Limited</td>
                        <td>Excellent</td>
                        <td>Limited</td>
                    </tr>
                    <tr>
                        <td><strong>Computational Cost</strong></td>
                        <td>Low</td>
                        <td>High</td>
                        <td>Very Low</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h2>💡 Key Takeaways</h2>
        <div class="success-box">
            <h3>Understanding HMMs</h3>
            <ol>
                <li><strong>Hidden vs Observable:</strong> HMMs model situations where true states are hidden but produce observable outputs</li>
                <li><strong>Markov Property:</strong> Future depends only on present, not past history</li>
                <li><strong>Three Problems:</strong> Evaluation (likelihood), Decoding (best path), Learning (parameters)</li>
                <li><strong>Wide Applications:</strong> Speech recognition, finance, bioinformatics, NLP</li>
                <li><strong>Strengths:</strong> Works with limited data, interpretable, mathematically elegant</li>
                <li><strong>Limitations:</strong> Assumes Markov property, limited long-term memory</li>
            </ol>
        </div>

        <div class="warning-box">
            <h3>⚠️ When NOT to Use HMMs</h3>
            <ul>
                <li>Long-range dependencies are crucial (use RNNs/Transformers)</li>
                <li>States are directly observable (use regular Markov chains)</li>
                <li>Non-sequential data (use other ML models)</li>
                <li>Very complex state spaces (consider deep learning)</li>
            </ul>
        </div>

        <div class="info-box">
            <h3>🚀 Modern Alternatives</h3>
            <p>While HMMs are still widely used, modern alternatives include:</p>
            <ul>
                <li><strong>CRFs (Conditional Random Fields):</strong> Don't assume independence of observations</li>
                <li><strong>RNNs/LSTMs:</strong> Better for complex sequences with long dependencies</li>
                <li><strong>Transformer Models:</strong> State-of-the-art for NLP tasks</li>
                <li><strong>Deep Markov Models:</strong> Combine deep learning with Markov assumptions</li>
            </ul>
        </div>
    </div>

    <script>
        // Initialize chart
        const ctx = document.getElementById('hmmChart').getContext('2d');
        const hmmChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                datasets: [
                    {
                        label: 'Hidden State Probability (Healthy)',
                        data: [0.9, 0.85, 0.7, 0.5, 0.3, 0.4, 0.6],
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'Hidden State Probability (Sick)',
                        data: [0.1, 0.15, 0.3, 0.5, 0.7, 0.6, 0.4],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'HMM State Probabilities Over Time',
                        font: { size: 16 }
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 1,
                        title: {
                            display: true,
                            text: 'Probability'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Time'
                        }
                    }
                }
            }
        });

        // Tab functionality
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Solve weather HMM
        function solveWeatherHMM() {
            const solution = document.getElementById('weatherSolution');
            solution.innerHTML = '<h4>🔍 Viterbi Algorithm Solution:</h4>';
            
            const steps = [
                { day: 1, obs: 'Jacket', weather: 'Rainy', prob: '0.16' },
                { day: 2, obs: 'T-shirt', weather: 'Sunny', prob: '0.024' },
                { day: 3, obs: 'T-shirt', weather: 'Sunny', prob: '0.010' },
                { day: 4, obs: 'Umbrella', weather: 'Rainy', prob: '0.002' },
                { day: 5, obs: 'Jacket', weather: 'Rainy', prob: '0.0005' }
            ];
            
            solution.innerHTML += '<div class="viterbi-path">';
            steps.forEach((step, index) => {
                solution.innerHTML += `
                    <div class="path-node">
                        <strong>Day ${step.day}</strong><br>
                        ${step.obs}<br>
                        <span style="color: #667eea;">${step.weather}</span><br>
                        <small>P=${step.prob}</small>
                    </div>
                    ${index < steps.length - 1 ? '<span class="path-arrow">→</span>' : ''}
                `;
            });
            solution.innerHTML += '</div>';
            
            solution.innerHTML += `
                <div class="success-box" style="margin-top: 20px;">
                    <strong>Most Likely Weather Sequence:</strong><br>
                    Rainy → Sunny → Sunny → Rainy → Rainy<br>
                    <small>This explains why your friend wore those clothes!</small>
                </div>
            `;
        }

        // Simulate patient HMM
        function simulatePatientHMM() {
            const results = document.getElementById('patientResults');
            results.innerHTML = '<h4>📊 Monitoring Patient Vitals...</h4>';
            
            const observations = [
                { time: '8 AM', vitals: 'Normal', hidden: 'Healthy', confidence: '92%' },
                { time: '12 PM', vitals: 'Elevated Temp', hidden: 'Mild Illness', confidence: '75%' },
                { time: '4 PM', vitals: 'High Fever', hidden: 'Severe Illness', confidence: '88%' },
                { time: '8 PM', vitals: 'Elevated Temp', hidden: 'Mild Illness', confidence: '70%' },
                { time: '12 AM', vitals: 'Normal', hidden: 'Recovering', confidence: '65%' }
            ];
            
            observations.forEach((obs, index) => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = 'day-card animate-pulse';
                    div.style.display = 'inline-block';
                    div.style.margin = '10px';
                    div.innerHTML = `
                        <strong>${obs.time}</strong><br>
                        Observed: ${obs.vitals}<br>
                        <span style="color: #667eea;">State: ${obs.hidden}</span><br>
                        <small>Confidence: ${obs.confidence}</small>
                    `;
                    results.appendChild(div);
                    
                    if (index === observations.length - 1) {
                        results.innerHTML += `
                            <div class="info-box" style="margin-top: 20px;">
                                <strong>Diagnosis Path:</strong> Healthy → Mild Illness → Severe Illness → Mild Illness → Recovering<br>
                                <strong>Action:</strong> Patient responded well to treatment, continue monitoring
                            </div>
                        `;
                    }
                }, (index + 1) * 500);
            });
        }
    </script>
</body>
</html>
