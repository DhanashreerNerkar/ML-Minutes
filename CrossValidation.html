<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross-Validation Complete Guide</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        .intro-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .problem-solution {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }
        .problem-card, .solution-card {
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .problem-card {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            color: white;
        }
        .solution-card {
            background: linear-gradient(135deg, #48c774 0%, #3273dc 100%);
            color: white;
        }
        .cv-visualization {
            margin: 40px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 20px;
        }
        .fold-container {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            transition: all 0.3s;
        }
        .fold {
            flex: 1;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            transition: all 0.3s;
            cursor: pointer;
        }
        .fold-train {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .fold-test {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: scale(1.05);
        }
        .fold-inactive {
            background: #95a5a6;
            opacity: 0.5;
        }
        .cv-type-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }
        .interactive-demo {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.3s;
        }
        button:hover {
            transform: scale(1.1);
        }
        .metrics-display {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .metric-box {
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        .metric-box:hover {
            transform: translateY(-5px);
        }
        .metric-label {
            color: #667eea;
            font-weight: bold;
            font-size: 0.9em;
        }
        .metric-value {
            font-size: 1.8em;
            color: #2c3e50;
            margin-top: 5px;
        }
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 30px auto;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
        }
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
            background: white;
        }
        .comparison-table tr:hover td {
            background: #f5f6fa;
        }
        .highlight {
            background: linear-gradient(135deg, #74b9ff 0%, #a29bfe 100%);
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-weight: bold;
        }
        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        .real-world-example {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .cv-animation {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .data-point {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.5s;
        }
        .point-train {
            background: #3498db;
        }
        .point-test {
            background: #e74c3c;
        }
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .pros {
            background: #d4edda;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }
        .cons {
            background: #f8d7da;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #dc3545;
        }
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .strategy-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            border-top: 4px solid #667eea;
        }
        .strategy-card:hover {
            transform: translateY(-10px);
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .animated-fold {
            animation: slideIn 0.5s ease-out;
        }
        .decision-flowchart {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }
        .best-practice {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .fold-iteration {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        .iteration-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #ecf0f1;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔄 Cross-Validation Explained</h1>
        <p class="subtitle">The Gold Standard for Model Evaluation</p>

        <div class="intro-box">
            <h2 style="color: #667eea; margin-bottom: 20px;">🎯 What is Cross-Validation?</h2>
            <p style="font-size: 1.1em; line-height: 1.8;">
                <strong>Cross-validation</strong> is like getting multiple opinions before making an important decision. 
                Instead of testing your model once, you test it multiple times on different parts of your data to ensure 
                it truly works well, not just on one lucky split.
            </p>
            <div style="text-align: center; margin: 30px 0;">
                <p style="font-size: 1.3em; color: #667eea;">
                    <strong>The Core Idea:</strong><br>
                    "Don't put all your evaluation eggs in one basket!"
                </p>
            </div>
        </div>

        <div class="problem-solution">
            <div class="problem-card">
                <h3>❌ The Problem: Single Train-Test Split</h3>
                <ul style="margin-top: 15px;">
                    <li>Results depend on one random split</li>
                    <li>Might get lucky (or unlucky)</li>
                    <li>Wastes data (only trains on 70-80%)</li>
                    <li>High variance in performance estimates</li>
                    <li>Can't trust the evaluation</li>
                </ul>
                <div style="text-align: center; margin-top: 20px; font-size: 2em;">😰</div>
            </div>
            
            <div class="solution-card">
                <h3>✅ The Solution: Cross-Validation</h3>
                <ul style="margin-top: 15px;">
                    <li>Multiple train-test splits</li>
                    <li>Every data point used for both training AND testing</li>
                    <li>Average performance across all splits</li>
                    <li>More robust and reliable estimates</li>
                    <li>Confidence in results</li>
                </ul>
                <div style="text-align: center; margin-top: 20px; font-size: 2em;">😊</div>
            </div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">📊 How K-Fold Cross-Validation Works</h2>

        <div class="cv-visualization">
            <h3 style="text-align: center; margin-bottom: 20px;">5-Fold Cross-Validation Visualization</h3>
            <p style="text-align: center; margin-bottom: 20px;">Click "Start Animation" to see how data rotates through training and testing</p>
            
            <div id="cvIterations"></div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="startCVAnimation()">Start Animation</button>
                <button onclick="resetCVAnimation()">Reset</button>
            </div>
            
            <div class="metrics-display">
                <div class="metric-box">
                    <div class="metric-label">Current Fold</div>
                    <div class="metric-value" id="currentFold">0/5</div>
                </div>
                <div class="metric-box">
                    <div class="metric-label">Avg Accuracy</div>
                    <div class="metric-value" id="avgAccuracy">-</div>
                </div>
                <div class="metric-box">
                    <div class="metric-label">Std Dev</div>
                    <div class="metric-value" id="stdDev">-</div>
                </div>
            </div>
        </div>

        <div class="interactive-demo">
            <h2>🎮 Interactive Demo: Compare Evaluation Methods</h2>
            <p>See why cross-validation gives more reliable results</p>
            
            <div style="margin-top: 30px;">
                <button onclick="runSingleSplit()">Run Single Split</button>
                <button onclick="run5FoldCV()">Run 5-Fold CV</button>
                <button onclick="run10FoldCV()">Run 10-Fold CV</button>
            </div>
            
            <div class="chart-container">
                <canvas id="comparisonChart"></canvas>
            </div>
            
            <div id="resultsDisplay" style="margin-top: 20px;"></div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">🎯 Types of Cross-Validation</h2>

        <div class="cv-type-card">
            <h3>1️⃣ K-Fold Cross-Validation</h3>
            <p><strong>Most Common Method</strong></p>
            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-top: 20px;">
                <div>
                    <h4>How it works:</h4>
                    <ul>
                        <li>Split data into K equal parts</li>
                        <li>Train on K-1 folds</li>
                        <li>Test on 1 fold</li>
                        <li>Repeat K times</li>
                        <li>Average the results</li>
                    </ul>
                </div>
                <div>
                    <h4>Common K values:</h4>
                    <div style="display: flex; gap: 15px; margin-top: 10px;">
                        <div style="text-align: center;">
                            <div class="metric-box">
                                <div style="font-size: 2em;">5</div>
                                <div>Good balance</div>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div class="metric-box">
                                <div style="font-size: 2em;">10</div>
                                <div>More robust</div>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div class="metric-box">
                                <div style="font-size: 2em;">3</div>
                                <div>Faster</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="cv-type-card">
            <h3>2️⃣ Leave-One-Out Cross-Validation (LOOCV)</h3>
            <p><strong>Extreme Case: K = N (number of samples)</strong></p>
            <div class="pros-cons">
                <div class="pros">
                    <h4>✅ Pros</h4>
                    <ul>
                        <li>Uses maximum training data</li>
                        <li>No randomness</li>
                        <li>Good for small datasets</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>❌ Cons</h4>
                    <ul>
                        <li>Very computationally expensive</li>
                        <li>High variance</li>
                        <li>Not feasible for large datasets</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="cv-type-card">
            <h3>3️⃣ Stratified K-Fold</h3>
            <p><strong>Preserves Class Distribution in Each Fold</strong></p>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h4>Example: Binary Classification</h4>
                <p>Dataset: 100 samples (70% Class A, 30% Class B)</p>
                <p>Regular K-Fold: Folds might have different class ratios</p>
                <p><span class="highlight">Stratified K-Fold: Every fold maintains 70%-30% ratio</span></p>
            </div>
        </div>

        <div class="cv-type-card">
            <h3>4️⃣ Time Series Cross-Validation</h3>
            <p><strong>Special Case for Temporal Data</strong></p>
            <div style="text-align: center; margin-top: 20px;">
                <div style="display: inline-block; text-align: left;">
                    <p>Fold 1: Train[Jan-Mar] → Test[Apr]</p>
                    <p>Fold 2: Train[Jan-Apr] → Test[May]</p>
                    <p>Fold 3: Train[Jan-May] → Test[Jun]</p>
                    <p style="margin-top: 10px;"><strong>Always respect temporal order!</strong></p>
                </div>
            </div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">📈 Real-World Example: Medical Diagnosis</h2>

        <div class="real-world-example">
            <h3>🏥 Predicting Heart Disease</h3>
            <p><strong>Dataset:</strong> 300 patients with 13 features</p>
            <p><strong>Task:</strong> Predict presence of heart disease</p>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                <h4>Results Comparison:</h4>
                <table class="comparison-table" style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Accuracy</th>
                            <th>Confidence</th>
                            <th>Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Single 70-30 Split</td>
                            <td>82% (one result)</td>
                            <td>Low ⚠️</td>
                            <td>1x</td>
                        </tr>
                        <tr>
                            <td>5-Fold CV</td>
                            <td>85% ± 3%</td>
                            <td>High ✅</td>
                            <td>5x</td>
                        </tr>
                        <tr>
                            <td>10-Fold CV</td>
                            <td>84% ± 2%</td>
                            <td>Very High ✅</td>
                            <td>10x</td>
                        </tr>
                        <tr>
                            <td>LOOCV</td>
                            <td>84.5% ± 0.5%</td>
                            <td>Highest ✅</td>
                            <td>300x</td>
                        </tr>
                    </tbody>
                </table>
                <p style="margin-top: 15px;"><strong>Insight:</strong> 5-Fold CV provides the best balance of reliability and computational cost</p>
            </div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">🎯 Why Cross-Validation is Important</h2>

        <div class="strategy-grid">
            <div class="strategy-card">
                <h3>1. Better Performance Estimates</h3>
                <p>Average across multiple tests reduces variance and gives more reliable metrics</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">📊</span>
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>2. Detect Overfitting</h3>
                <p>If training score >> CV score, your model is overfitting</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">🔍</span>
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>3. Model Selection</h3>
                <p>Compare different models fairly using the same CV strategy</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">🏆</span>
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>4. Hyperparameter Tuning</h3>
                <p>Find optimal parameters using CV to avoid overfitting to validation set</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">🎛️</span>
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>5. Use All Data</h3>
                <p>Every sample is used for both training and testing</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">💯</span>
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>6. Statistical Confidence</h3>
                <p>Get mean and standard deviation of performance</p>
                <div style="text-align: center; margin-top: 15px;">
                    <span style="font-size: 3em;">📈</span>
                </div>
            </div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">💻 Code Implementation</h2>

        <div class="code-block">
<pre># Python: Cross-Validation with scikit-learn

from sklearn.model_selection import cross_val_score, KFold, StratifiedKFold
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_iris
import numpy as np

# Load data
X, y = load_iris(return_X_y=True)
model = RandomForestClassifier()

# Method 1: Simple cross_val_score (uses StratifiedKFold for classification)
scores = cross_val_score(model, X, y, cv=5)
print(f"Accuracy: {scores.mean():.3f} (+/- {scores.std() * 2:.3f})")

# Method 2: Explicit KFold
kfold = KFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=kfold)

# Method 3: StratifiedKFold (maintains class distribution)
skfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=skfold)

# Method 4: Multiple metrics
from sklearn.model_selection import cross_validate

scoring = ['accuracy', 'precision_macro', 'recall_macro']
cv_results = cross_validate(model, X, y, cv=5, scoring=scoring)

for metric in scoring:
    scores = cv_results[f'test_{metric}']
    print(f"{metric}: {scores.mean():.3f} (+/- {scores.std():.3f})")

# Method 5: Custom CV for time series
from sklearn.model_selection import TimeSeriesSplit

tscv = TimeSeriesSplit(n_splits=5)
for train_idx, test_idx in tscv.split(X):
    X_train, X_test = X[train_idx], X[test_idx]
    y_train, y_test = y[train_idx], y[test_idx]
    # Train and evaluate model

# Method 6: GridSearchCV with cross-validation
from sklearn.model_selection import GridSearchCV

param_grid = {'n_estimators': [10, 50, 100], 'max_depth': [3, 5, 7]}
grid_search = GridSearchCV(model, param_grid, cv=5, scoring='accuracy')
grid_search.fit(X, y)
print(f"Best params: {grid_search.best_params_}")
print(f"Best CV score: {grid_search.best_score_:.3f}")</pre>
        </div>

        <div class="decision-flowchart">
            <h2 style="text-align: center;">🤔 How to Choose K in K-Fold?</h2>
            <div style="margin-top: 30px;">
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>K Value</th>
                            <th>Training Size</th>
                            <th>Variance</th>
                            <th>Computation</th>
                            <th>Use When</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>K=3</strong></td>
                            <td>67%</td>
                            <td>High</td>
                            <td>Fast</td>
                            <td>Quick experiments</td>
                        </tr>
                        <tr>
                            <td><strong>K=5</strong></td>
                            <td>80%</td>
                            <td>Moderate</td>
                            <td>Moderate</td>
                            <td>Good default choice</td>
                        </tr>
                        <tr>
                            <td><strong>K=10</strong></td>
                            <td>90%</td>
                            <td>Lower</td>
                            <td>Slower</td>
                            <td>Need robust estimates</td>
                        </tr>
                        <tr>
                            <td><strong>K=N (LOOCV)</strong></td>
                            <td>~100%</td>
                            <td>Lowest bias</td>
                            <td>Very slow</td>
                            <td>Small datasets</td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="text-align: center; margin-top: 20px; padding: 20px; background: white; border-radius: 10px;">
                    <h3>Rule of Thumb:</h3>
                    <p><span class="highlight">K=5 or K=10</span> for most cases</p>
                    <p style="margin-top: 10px;">Smaller K (3) for large datasets or expensive models</p>
                    <p>Larger K or LOOCV for small datasets (&lt;1000 samples)</p>
                </div>
            </div>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">⚠️ Common Pitfalls to Avoid</h2>

        <div class="warning-box">
            <h3>⚠️ Pitfall 1: Data Leakage</h3>
            <p><strong>Wrong:</strong> Normalize entire dataset → then split</p>
            <p><strong>Right:</strong> Split → normalize training → apply to test</p>
            <div class="code-block" style="margin-top: 15px;">
<pre># WRONG - causes data leakage
X_scaled = StandardScaler().fit_transform(X)  # Don't do this!
scores = cross_val_score(model, X_scaled, y)

# RIGHT - use Pipeline
from sklearn.pipeline import Pipeline
pipe = Pipeline([
    ('scaler', StandardScaler()),
    ('model', RandomForestClassifier())
])
scores = cross_val_score(pipe, X, y)  # Scaling happens within each fold</pre>
            </div>
        </div>

        <div class="warning-box">
            <h3>⚠️ Pitfall 2: Not Stratifying Imbalanced Data</h3>
            <p>With 95% Class A, 5% Class B, regular K-fold might create folds with no Class B!</p>
            <p><strong>Solution:</strong> Always use StratifiedKFold for classification</p>
        </div>

        <div class="warning-box">
            <h3>⚠️ Pitfall 3: Using CV on Time Series Wrong</h3>
            <p>Regular K-fold shuffles data - breaks temporal order!</p>
            <p><strong>Solution:</strong> Use TimeSeriesSplit or custom forward-chaining</p>
        </div>

        <h2 style="text-align: center; color: #667eea; margin: 40px 0;">🏆 Cross-Validation Best Practices</h2>

        <div class="best-practice">
            <h3 style="text-align: center;">✨ Golden Rules for Cross-Validation</h3>
            <ol style="line-height: 2; margin-top: 20px;">
                <li><strong>Set random seed</strong> for reproducibility</li>
                <li><strong>Use stratification</strong> for classification tasks</li>
                <li><strong>Apply preprocessing</strong> within CV loop (use Pipeline)</li>
                <li><strong>Report mean AND standard deviation</strong> of scores</li>
                <li><strong>Use appropriate CV</strong> for your data type (time series, grouped, etc.)</li>
                <li><strong>Don't use test set</strong> during CV - save it for final evaluation</li>
                <li><strong>Consider computational cost</strong> - more folds = more time</li>
                <li><strong>Use same CV strategy</strong> when comparing models</li>
            </ol>
        </div>

        <div class="success-box">
            <h3>✅ When to Use Cross-Validation</h3>
            <ul>
                <li>Comparing multiple models</li>
                <li>Tuning hyperparameters</li>
                <li>Small to medium datasets (&lt;100k samples)</li>
                <li>When you need confidence intervals</li>
                <li>Research and competitions</li>
            </ul>
        </div>

        <div class="warning-box">
            <h3>❌ When NOT to Use Cross-Validation</h3>
            <ul>
                <li>Very large datasets (use single validation set)</li>
                <li>Deep learning (too expensive, use validation set)</li>
                <li>Online learning scenarios</li>
                <li>When training takes days</li>
            </ul>
        </div>

        <div class="interactive-demo" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <h2 style="color: white;">🎯 Key Takeaways</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 30px;">
                <div style="background: white; padding: 20px; border-radius: 10px; color: #2c3e50;">
                    <h3 style="color: #667eea;">What</h3>
                    <p>Test model multiple times on different data splits</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; color: #2c3e50;">
                    <h3 style="color: #667eea;">Why</h3>
                    <p>More reliable performance estimates than single split</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; color: #2c3e50;">
                    <h3 style="color: #667eea;">When</h3>
                    <p>Model selection, hyperparameter tuning, final evaluation</p>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; color: #2c3e50;">
                    <h3 style="color: #667eea;">How</h3>
                    <p>K-Fold (usually K=5 or 10), Stratified for classification</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize charts
        let comparisonChart;
        let currentAnimationStep = 0;
        let animationInterval;
        
        // Generate CV visualization
        function generateCVVisualization() {
            const container = document.getElementById('cvIterations');
            container.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const iteration = document.createElement('div');
                iteration.className = 'fold-iteration';
                
                const number = document.createElement('div');
                number.className = 'iteration-number';
                number.textContent = i + 1;
                
                const foldContainer = document.createElement('div');
                foldContainer.className = 'fold-container';
                foldContainer.style.flex = '1';
                
                for (let j = 0; j < 5; j++) {
                    const fold = document.createElement('div');
                    fold.className = 'fold fold-inactive';
                    fold.textContent = `Fold ${j + 1}`;
                    fold.id = `fold-${i}-${j}`;
                    foldContainer.appendChild(fold);
                }
                
                iteration.appendChild(number);
                iteration.appendChild(foldContainer);
                container.appendChild(iteration);
            }
        }
        
        function startCVAnimation() {
            currentAnimationStep = 0;
            const accuracies = [];
            
            animationInterval = setInterval(() => {
                if (currentAnimationStep >= 5) {
                    clearInterval(animationInterval);
                    
                    // Calculate and display final metrics
                    const avg = accuracies.reduce((a, b) => a + b, 0) / accuracies.length;
                    const variance = accuracies.map(x => Math.pow(x - avg, 2)).reduce((a, b) => a + b, 0) / accuracies.length;
                    const std = Math.sqrt(variance);
                    
                    document.getElementById('avgAccuracy').textContent = `${avg.toFixed(1)}%`;
                    document.getElementById('stdDev').textContent = `±${std.toFixed(1)}%`;
                    return;
                }
                
                // Reset previous iteration
                if (currentAnimationStep > 0) {
                    for (let j = 0; j < 5; j++) {
                        const fold = document.getElementById(`fold-${currentAnimationStep - 1}-${j}`);
                        fold.className = 'fold fold-inactive';
                    }
                }
                
                // Animate current iteration
                for (let j = 0; j < 5; j++) {
                    const fold = document.getElementById(`fold-${currentAnimationStep}-${j}`);
                    if (j === currentAnimationStep) {
                        fold.className = 'fold fold-test animated-fold';
                    } else {
                        fold.className = 'fold fold-train animated-fold';
                    }
                }
                
                // Generate random accuracy for this fold
                const accuracy = 80 + Math.random() * 10;
                accuracies.push(accuracy);
                
                document.getElementById('currentFold').textContent = `${currentAnimationStep + 1}/5`;
                currentAnimationStep++;
            }, 1500);
        }
        
        function resetCVAnimation() {
            clearInterval(animationInterval);
            currentAnimationStep = 0;
            document.getElementById('currentFold').textContent = '0/5';
            document.getElementById('avgAccuracy').textContent = '-';
            document.getElementById('stdDev').textContent = '-';
            
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const fold = document.getElementById(`fold-${i}-${j}`);
                    if (fold) fold.className = 'fold fold-inactive';
                }
            }
        }
        
        // Initialize comparison chart
        function initComparisonChart() {
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            comparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Accuracy (%)',
                        data: [],
                        backgroundColor: [],
                        borderColor: [],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Evaluation Method Comparison',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Accuracy (%)'
                            }
                        }
                    }
                }
            });
        }
        
        function runSingleSplit() {
            const accuracy = 75 + Math.random() * 15;
            
            comparisonChart.data.labels = ['Single Split'];
            comparisonChart.data.datasets[0].data = [accuracy];
            comparisonChart.data.datasets[0].backgroundColor = ['#e74c3c'];
            comparisonChart.data.datasets[0].borderColor = ['#c0392b'];
            comparisonChart.update();
            
            document.getElementById('resultsDisplay').innerHTML = `
                <div class="warning-box">
                    <h4>Single Split Result</h4>
                    <p>Accuracy: ${accuracy.toFixed(1)}%</p>
                    <p>⚠️ High uncertainty - results depend on this specific split!</p>
                </div>
            `;
        }
        
        function run5FoldCV() {
            const scores = [];
            for (let i = 0; i < 5; i++) {
                scores.push(78 + Math.random() * 12);
            }
            const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
            const std = Math.sqrt(scores.map(x => Math.pow(x - avg, 2)).reduce((a, b) => a + b, 0) / scores.length);
            
            comparisonChart.data.labels = scores.map((_, i) => `Fold ${i + 1}`);
            comparisonChart.data.labels.push('Average');
            comparisonChart.data.datasets[0].data = [...scores, avg];
            comparisonChart.data.datasets[0].backgroundColor = [
                ...scores.map(_ => '#3498db'),
                '#27ae60'
            ];
            comparisonChart.data.datasets[0].borderColor = [
                ...scores.map(_ => '#2980b9'),
                '#229954'
            ];
            comparisonChart.update();
            
            document.getElementById('resultsDisplay').innerHTML = `
                <div class="success-box">
                    <h4>5-Fold CV Result</h4>
                    <p>Average Accuracy: ${avg.toFixed(1)}% ± ${std.toFixed(1)}%</p>
                    <p>✅ More reliable estimate with confidence interval!</p>
                </div>
            `;
        }
        
        function run10FoldCV() {
            const scores = [];
            for (let i = 0; i < 10; i++) {
                scores.push(79 + Math.random() * 10);
            }
            const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
            const std = Math.sqrt(scores.map(x => Math.pow(x - avg, 2)).reduce((a, b) => a + b, 0) / scores.length);
            
            comparisonChart.data.labels = scores.map((_, i) => `F${i + 1}`);
            comparisonChart.data.labels.push('Average');
            comparisonChart.data.datasets[0].data = [...scores, avg];
            comparisonChart.data.datasets[0].backgroundColor = [
                ...scores.map(_ => '#9b59b6'),
                '#27ae60'
            ];
            comparisonChart.data.datasets[0].borderColor = [
                ...scores.map(_ => '#8e44ad'),
                '#229954'
            ];
            comparisonChart.update();
            
            document.getElementById('resultsDisplay').innerHTML = `
                <div class="success-box">
                    <h4>10-Fold CV Result</h4>
                    <p>Average Accuracy: ${avg.toFixed(1)}% ± ${std.toFixed(1)}%</p>
                    <p>✅ Even more robust with lower variance!</p>
                    <p>Note: Takes 2x longer than 5-fold CV</p>
                </div>
            `;
        }
        
        // Initialize on load
        window.onload = function() {
            generateCVVisualization();
            initComparisonChart();
        };
    </script>
</body>
</html>
